requiredPackages <- c("readr", "purrr", "stringr", "tm", "arrow", "digest",
"tidyverse","quanteda", "tidytext")
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
ipak(requiredPackages)
remove(requiredPackages, ipak)
Get_File_Hash_App <- function(app_name){
return(digest(file(paste("../APK/",app_name)), "sha256"))
}
Get_Version_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
return(app_version)
}
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,' | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
Create_Dataframe_From_Files <- function(){
files <- list.files("../../APK")
indices_to_remove <- grep("idsig", files)
files <- files[-indices_to_remove]
df=data.frame("file_names"=c(files))
df$hash <- apply(df["file_names"], 1, Get_File_Hash_App)
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
df$package <- apply(df["file_names"], 1, Get_Package_From_App)
df$CompileSdkVersion <- apply(df["file_names"], 1, Get_Version_From_App)
return(df)
}
Compile_Framework <- function(){
cmd = paste("javac -d Classes -cp '../Jar_Libs/*' *.java Conditions/*.java Soot/*.java Logging/Logging.java FileWriter/*.java FileParser/*.java FileHandler/*.java Constants/*.java ClassHelper/*.java Utils/*.java")
system(cmd)
}
Run_Framework <- function(app_name){
main_activity<-Get_Main_Activity_From_App(app_name)
hash <- digest(file(paste("../APK/",app_name)), "sha256")
cmd<-paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,main_activity,hash," --output-format J -force-overwrite")
system(cmd)
}
Zip_Sign_And_Install_APK <- function(app_name){
app_name_only=gsub(".apk", "", app_name)
cmd<-paste('zipalign -fv 4 sootOutput/',app_name_only,'/',app_name,' sootOutput/',app_name_only,'/signed',app_name, sep="")
system(cmd)
cmd<-paste('apksigner sign --ks ../my-release-key.keystore --ks-pass pass:password sootOutput/',app_name_only,'/signed',app_name, sep="")
system(cmd)
cmd<-paste('rm  sootOutput/',app_name_only,'/*.idsig', sep="")
system(cmd)
cmd<-paste('adb install sootOutput/',app_name_only,'/signed',app_name, sep="")
system(cmd)
}
Run_App_On_Emulator<- function(app_name){
cmd = ""
system(cmd)
}
App_To_Analyze = "BannerOnly.apk"
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
# App_To_Analyze = "BannerOnly.apk"
App_To_Analyze = "BannerOnly_Log_AdView.apk"
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
Run_Framework(App_To_Analyze)
# App_To_Analyze = "BannerOnly.apk"
App_To_Analyze = "BannerOnly_Log_AdView.apk"
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework()
Compile_Framework()
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework()
Compile_Framework()
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework(App_To_Analyze)

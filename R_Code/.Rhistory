requiredPackages <- c("readr", "purrr", "stringr", "tm", "arrow",
"tidyverse", "textmineR","cooccur", "birankr", "ngram",
"quanteda", "quanteda.textstats", "text2vec", "tidytext")
ipak <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[, "Package"])]
if (length(new.pkg))
install.packages(new.pkg, dependencies = TRUE)
sapply(pkg, require, character.only = TRUE)
}
ipak(requiredPackages)
remove(requiredPackages, ipak)
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, '.apk | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,'.apk | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
Run_Framework <- function(app_name){
main_activity=Get_Main_Activity_From_App(app_name)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format J")
system(cmd)
}
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3")
files=list.dirs("../../APK")
files=list.files("../../APK")
df=data.frame("file_names"=c(list.files("../../APK")))
View(df)
View(df)
df$main_activity <- apply(df["column1"], 1, Get_Main_Activity_From_App)
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,' | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
View(df)
df$package <- apply(df["file_names"], 1, Get_Package_From_App)
View(df)
app_name="TestApp3"
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
View(df)
View(df)
app_name="TestApp3"
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
app_version=system(cmd, intern = TRUE)
app_name="TestApp3.apk"
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=unlist(strsplit(app_version, " "))
app_version
app_version=system(cmd, intern = TRUE)
app_version=system(cmd, intern = TRUE)
app_version
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version
app_version=unlist(strsplit(app_version, " "))
app_version
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
Get_Version_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
return(app_version)
}
df$CompileSdkVersion <- apply(df["file_names"], 1, Get_Version_From_App)
cols_to_remove <- which(grepl("idsig", df[1, ]))
View(df)
cols_to_remove <- which(grepl("idsig", df[1, ]))
df <- df[- grep("idsig", df$file_names),]
View(df)
app_version=str_replace_all(app_version,"'","")
View(df)
app_name="angrybirdsrio.apk"
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version
Get_Version_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
return(app_version)
}
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,' | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
Create_Dataframe_From_Files(){
Get_Version_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
return(app_version)
}
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,' | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
Create_Dataframe_From_Files <- function(){
df=data.frame("file_names"=c(list.files("../../APK")))
df <- df[- grep("idsig", df$file_names),]
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
df$package <- apply(df["file_names"], 1, Get_Package_From_App)
df$CompileSdkVersion <- apply(df["file_names"], 1, Get_Version_From_App)
return(df)
}
Run_Framework <- function(app_name){
main_activity=Get_Main_Activity_From_App(app_name)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format J")
system(cmd)
}
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
df = Create_Dataframe_From_Files()
df=data.frame("file_names"=c(list.files("../../APK")))
df <- df[- grep("idsig", df$file_names),]
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
df=data.frame("file_names"=c(list.files("../../APK")))
df[- grep("idsig", df$file_names),]
df$file_names = unlist(df[- grep("idsig", df$file_names),])
df = unlist(df[- grep("idsig", df$file_names),])
df=data.frame("file_names"=c(list.files("../../APK")))
df = df[- grep("idsig", df$file_names),]
df=data.frame("file_names"=c(list.files("../../APK")))
df$file_names = df[- grep("idsig", df$file_names),]
df$file_names = df[!grepl("idsig", df$file_names),]
df %>% filter(!grepl('idsig', file_names))
df$file_names = df %>% filter(!grepl('idsig', file_names))
files <- list.files("../../APK")
files <- list.files("../../APK")
indices_to_remove <- grep("idsig", files)
files <- files[-indices_to_remove]
Get_Version_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep package', sep='')
app_version=system(cmd, intern = TRUE)
app_version=unlist(strsplit(app_version, " "))
app_version=app_version[7]
app_version=str_replace(app_version,"compileSdkVersion=","")
app_version=str_replace_all(app_version,"'","")
return(app_version)
}
Get_Main_Activity_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name, ' | grep launchable-activity', sep='')
main_activity=system(cmd, intern = TRUE)
main_activity=unlist(strsplit(main_activity, " "))
main_activity=main_activity[2]
main_activity=str_replace(main_activity,"name=","")
main_activity=str_replace_all(main_activity,"'","")
return(main_activity)
}
Get_Package_From_App <- function(app_name){
cmd = paste('aapt dump badging ../../APK/',app_name,' | grep "package"', sep='')
package=system(cmd, intern = TRUE)
package=unlist(strsplit(package, " "))
package=package[2]
package=str_replace(package,"name=","")
package=str_replace_all(package,"'","")
return(package)
}
Create_Dataframe_From_Files <- function(){
files <- list.files("../../APK")
indices_to_remove <- grep("idsig", files)
files <- files[-indices_to_remove]
df=data.frame("file_names"=c(files))
df$main_activity <- apply(df["file_names"], 1, Get_Main_Activity_From_App)
df$package <- apply(df["file_names"], 1, Get_Package_From_App)
df$CompileSdkVersion <- apply(df["file_names"], 1, Get_Version_From_App)
return(df)
}
Run_Framework <- function(app_name){
main_activity=Get_Main_Activity_From_App(app_name)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format J")
system(cmd)
}
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
df = Create_Dataframe_From_Files()
View(df)
View(df)
View(df)
View(df)
cmd = paste("javac -d Classes -cp '../Jar_Libs/*' *.java Conditions/*.java Soot/*.java Logging/Logging.java FileWriter/*.java FileParser/*.java FileHandler/*.java Constants/*.java ClassHelper/*.java Utils/*.java")
system(cmd)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework <- function(){
cmd = paste("javac -d Classes -cp '../Jar_Libs/*' *.java Conditions/*.java Soot/*.java Logging/Logging.java FileWriter/*.java FileParser/*.java FileHandler/*.java Constants/*.java ClassHelper/*.java Utils/*.java")
system(cmd)
}
Compile_Framework()
Compile_Framework <- function(){
cmd = paste("javac -d Classes -cp '../Jar_Libs/*' *.java")
system(cmd)
}
Compile_Framework()
Compile_Framework <- function(){
cmd = paste("javac -d Classes -cp '../Jar_Libs/*' *.java Conditions/*.java Soot/*.java Logging/Logging.java FileWriter/*.java FileParser/*.java FileHandler/*.java Constants/*.java ClassHelper/*.java Utils/*.java")
system(cmd)
}
Compile_Framework()
install.packages("appium")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
Compile_Framework()
Compile_Framework()
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
main_activity=Get_Main_Activity_From_App(app_name)
Run_Framework <- function(app_name){
main_activity=Get_Main_Activity_From_App(app_name)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format j")
system(cmd)
}
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
cmd
View(df)
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
Run_Framework <- function(app_name){
main_activity=Get_Main_Activity_From_App(app_name)
assign("main_activity", "main_activity", envir = .GlobalEnv)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format j")
system(cmd)
}
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
Run_Framework <- function(app_name){
main_activity<<-Get_Main_Activity_From_App(app_name)
assign("main_activity", "main_activity", envir = .GlobalEnv)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format j")
system(cmd)
}
Run_Framework("TestApp3.apk")
Run_Framework <- function(app_name){
main_activity<<-Get_Main_Activity_From_App(app_name)
cmd = paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format j")
system(cmd)
}
# Load required libraries
requiredPackages <- c("readr", "purrr", "stringr", "tm", "arrow",
"tidyverse", "textmineR","cooccur", "birankr", "ngram",
"quanteda", "quanteda.textstats", "text2vec", "tidytext")
Get_Main_Activity_From_App("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
Get_Main_Activity_From_App("TestApp3.apk")
setwd("~/Desktop/MADScannerFinalGoldV2/Java")
Compile_Framework()
setwd("~/Desktop/MADScannerFinalGoldV2/Java/Classes")
Run_Framework("TestApp3.apk")
Get_Main_Activity_From_App("TestApp3.apk")
Run_Framework <- function(app_name){
main_activity<<-Get_Main_Activity_From_App(app_name)
cmd<<-paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,".apk ",main_activity," --output-format j")
system(cmd)
}
Run_Framework("TestApp3.apk")
View(df)
cmd
Run_Framework <- function(app_name){
main_activity<<-Get_Main_Activity_From_App(app_name)
cmd<<-paste("java -cp .:../../Jar_Libs/* SootTest ",app_name,main_activity," --output-format j")
system(cmd)
}
Run_Framework("TestApp3.apk")
